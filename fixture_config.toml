# OpenFixture Configuration File
# TOML format for fixture generation parameters
#
# This file allows you to define project-specific fixture parameters
# Command-line arguments will override these settings
#
# Last Updated: February 15, 2026

# ============================================================================
# BOARD PARAMETERS
# ============================================================================
[board]
# PCB thickness in millimeters
# Standard values: 0.8, 1.0, 1.6, 2.0, 2.4
thickness_mm = 1.6

# Test point layer selection
# Options: "F.Cu" (front/top), "B.Cu" (back/bottom), "both" (both sides)
test_layer = "F.Cu"

# Override board revision (optional)
# If not set, reads from PCB file title block
# revision = "rev_01"

# ============================================================================
# TEST POINT DETECTION
# ============================================================================
[test_points]
# Pad types to include as test points
# SMD: Surface mount pads (designed test points)
# PTH: Plated through-hole pads (connector pins, component leads)
#      Note: PTH pads are only detected from components on the OPPOSITE side
#      Example: Testing from bottom → Only uses PTH from top-side components
#      Reason: Component body blocks access, pins accessible from other side
include_smd_pads = true
include_pth_pads = true

# Pad filtering
# - Pads with solder paste mask are excluded (unless on force_layer)
# - Pads on ignore_layer (Eco1.User) are excluded
# - Pads on force_layer (Eco2.User) are always included
# - Test Point symbols (TP*) from schematic are automatically included

# ============================================================================
# MATERIAL PARAMETERS
# ============================================================================
[material]
# Material thickness in millimeters
# Common acrylic: 2.45, 3.0, 4.0
# Common plywood: 3.0, 5.0
thickness_mm = 3.0

# Laser kerf compensation (handled in OpenSCAD)
# Typical: 0.1-0.2mm for acrylic
# kerf_mm = 0.125

# ============================================================================
# HARDWARE PARAMETERS
# ============================================================================
[hardware]
# Screw specifications (M3 recommended)
screw_diameter_mm = 3.0
screw_length_mm = 16.0

# Hex nut dimensions (M3 typical values)
nut_thickness_mm = 2.4
nut_flat_to_flat_mm = 5.45
nut_corner_to_corner_mm = 6.10

# Washer thickness (optional, for smoother hinge operation)
washer_thickness_mm = 1.0

# Pivot hole diameter (tight fit for alignment)
# Default: screw_diameter - 0.1
# For bushing: 5.12
pivot_diameter_mm = 2.9

# PCB support border width
# Ledge that holds PCB in place
border_mm = 0.8

# Pogo pin specifications
pogo_uncompressed_length_mm = 16.0
# pogo_compression_mm = 1.0  # Target compression (handled in OpenSCAD)
# pogo_diameter_mm = 1.5     # Receptacle diameter (handled in OpenSCAD)

# ============================================================================
# LAYER CONFIGURATION
# ============================================================================
[layers]
# Force include layer - pads on this layer are always test points
# Default: Eco2.User
force_layer = "Eco2.User"

# Ignore layer - pads on this layer are never test points
# Default: Eco1.User
ignore_layer = "Eco1.User"

# ============================================================================
# OUTPUT SETTINGS
# ============================================================================
[output]
# Output directory (relative to project)
directory = "fixture"

# Generate additional files
export_test_cut = true       # Small test piece for material verification
export_3d_preview = true     # PNG rendering of assembled fixture
export_validation = true     # Track overlay for test point verification

# ============================================================================
# ADVANCED SETTINGS
# ============================================================================
[advanced]
# Enable verbose logging (creates detailed log file)
verbose_logging = false

# Coordinate correction offsets (fine-tune alignment)
# Usually not needed, but can compensate for systematic errors
tp_correction_offset_x = 0.0
tp_correction_offset_y = 0.0

# Minimum angle for pogo pin contact (degrees)
# Closer to 90° is better for reliable contact
min_pogo_contact_angle = 89.5

# ============================================================================
# EXAMPLE CONFIGURATIONS
# ============================================================================
# Copy and modify these values in the active sections above to match your needs
#
# Standard: 1.6mm PCB + 3mm acrylic + M3x16 screws
# Thin PCB: 0.8mm PCB + 2.45mm acrylic + M3x14 screws  
# Heavy-duty: 2.0mm PCB + 5mm plywood + M3x20 screws + 1.5mm border

# ============================================================================
# NOTES
# ============================================================================
#
# Material Thickness:
#   - Measure actual material with calipers
#   - Laser-cut materials can vary ±0.1mm
#   - Use test cut to verify fit
#
# Screw Length:
#   - Measure threaded length only (not head)
#   - Must be: screw_length >= material_thickness + pcb_thickness + nut_thickness + 3mm
#   - Excess length improves clamping but requires more clearance
#
# Nut Dimensions:
#   - Measure with calipers (varies by manufacturer)
#   - Flat-to-flat: Across parallel sides
#   - Corner-to-corner: Across diagonal
#   - Undersized holes can be carefully drilled out
#
# Pogo Pins:
#   - Uncompressed length: From receptacle top to pin tip
#   - Target compression: 1mm typical for good contact
#   - Force: 50-100g recommended (too many high-force pins = hard to close)
#
# Test Points:
#   - Default: SMD pads without paste mask
#   - Force include: Add Eco2.User layer to pad
#   - Ignore: Add Eco1.User layer to pad
#   - Minimum size: 0.5mm diameter for reliable probing
